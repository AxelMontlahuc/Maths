\documentclass[../main.tex]{subfiles}

\begin{document}
\setcounter{chapter}{18}
\chapter{Convexité}
\tableofcontents
\clearpage

\setsection{6}
\section{Position du graphe d'une fonction convexe par rapport à ses sécantes}
\begin{tcolorbox}[title=Propostion 19.7, title filled=false, colframe=lightblue, colback=lightblue!10!white]
    Soit $f:I\to \mathbb{R}$ une fonction convexe et $(x, y) \in I^2$ avec $x < y$. \\
    Le graphe de $f$ est situé en-dessous de sa sécante sur l'intervalle $[x, y]$ et au-dessus à l'extérieur, soit sur $I \cap ]-\infty, x] \cup [y, +\infty[$.
\end{tcolorbox}

\noindent On pose $g:\mathbb{R}\to \mathbb{R}; t\mapsto \frac{f(y) - f(x)}{y - x}(t - x) + f(x)$. \\
$g$ paramètre la sécante passant par les points $(x, f(x))$ et $(y, f(y))$. \\
\begin{itemize}
    \item Sur $[x, y]$, RAF car $f$ est convexe. 
    \item Soit $t > y$. On pose $\lambda = \frac{y-x}{t-x} \neq 0 \in [0, 1]$. On a : 
    \begin{align*}
        \lambda t + (1-\lambda)x &= \frac{y-x}{t-x}t + \left( 1 - \frac{y-x}{t-x}\right)x \\
        &= \frac{t(y-x) + x(t-y))}{t-x} \\
        &= y
    \end{align*}
    Par convexité de $f$ : 
    \begin{align*}
        f(y) &= f(\lambda t + (1-\lambda)x) \\
        &\leq \lambda f(t) + (1-\lambda)f(x) \\
        \text{donc } f(t) &\geq \frac{1}{y} f(y) - \left( \frac{1}{y} - 1 \right)f(x) \\
        &= \frac{t-x}{y-x} f(y) - \left( \frac{t-x}{y-x} - 1 \right)f(x) \\
        &= \frac{t-x}{y-x} \times (f(y) - f(x)) + f(x) \\
        &= g(t)
    \end{align*}

    \item On raisonne de la même manière si $t \leq x < y$. 
\end{itemize}

\section{Inégalités des pentes}
\begin{tcolorbox}[title=Propostion 19.8, title filled=false, colframe=lightblue, colback=lightblue!10!white]
    Soit $f:I\to \mathbb{R}$ une fonction définie sur un intervalle $I$. 
    \begin{enumerate}
        \item $f$ est convexe si et seulement si pour tout $a \in I$, la fonction $x\mapsto \frac{f(x) - f(a)}{x - a}$ est croissante sur $I\backslash\{a\}$. 
        \item Si $f$ est convexe, alors pour tout $(a, b, c) \in I^3$ avec $a < b < c$, 
        \begin{align*}
            \frac{f(b) - f(a)}{b-a} \leq \frac{f(c) - f(a)}{c-a} \leq \frac{f(c) - f(b)}{c-b}
        \end{align*}
    \end{enumerate}
\end{tcolorbox}

\begin{enumerate}
    \item $\boxed{\Rightarrow}$ \\
    On suppose $f$ convexe. Soit $a \in I$ et $x < y$ dans $I\backslash\{a\}$.
    \begin{itemize}
        \item On suppose $x < a < y$. D'après (19.7) : 
        \begin{align*}
            f(y) \leq \frac{f(a) - f(x)}{a-x} \times (y-a)) + f(a)
        \end{align*}
        Donc :
        \begin{align*}
            \frac{f(y) - f(a)}{y-a} \geq \frac{f(a) - f(x)}{a-x}
        \end{align*}
        \item Si $x < a < y$, d'après (19.7) :
        \begin{align*}
            f(y) \geq \frac{f(a) - f(x)}{a-x} \times (y-a) + f(a)
        \end{align*}
        Donc :
        \begin{align*}
            \frac{f(y) - f(a)}{y-a} \geq \frac{f(a) - f(x)}{a-x}
        \end{align*}
        \item Les autres cas s'y ramènent. 
    \end{itemize} 

    \noindent$\boxed{\Leftarrow}$ \\
    On suppose que pour tout $a \in I$, $g_a:I\backslash\{a\}\to \mathbb{R}; x\mapsto \frac{f(x) - f(a)}{x - a}$ est croissante. \\
    Soit $x < y$ et $\lambda \in ]0, 1[$. On pose $a = \lambda y + (1-\lambda)x$. \\
    $g_a$ est croissante sur $I\backslash\{a\}$, donc :
    \begin{align*}
        g_a(x) \leq g_a(y)
    \end{align*}
    Donc :
    \begin{align*}
        \frac{f(x) - f(a)}{x-a} \leq \frac{f(y) - f(a)}{y-a}
    \end{align*}
    Donc : 
    \begin{align*}
        x-a &< 0 \text{ et } y-a > 0 \\
        (f(x) - f(a))(y-a) &\leq (f(y) - f(a))(x-a) \\
        \text{donc } f(a)(y-x) &\leq f(x)(y-a) - f(y)(x-a) \\
        \text{soit } f(a) &\leq f(x) \frac{y-a}{y-x} + f(y) \frac{a-x}{y-x} \\
        &= (1 - \lambda)f(x) + \lambda f(y) \\
    \end{align*}

    \item Soit $a < b < c$. \\
    \begin{align*}
        g_a(b) \leq g_a(c) = g_c(a) \leq g_c(b)
    \end{align*}
\end{enumerate}

\section{Continuité et dérivabilité des fonctions convexes}
\begin{tcolorbox}[title=Théorème 19.9, title filled=false, colframe=orange, colback=orange!10!white]
    Soit $f$ une fonction convexe sur un intervalle $I$ ouvert. La fonction $f$ est alors continue et possède des dérivées à gauche et à droite en tout point (où les limites osnt envisageables). Pour tout $a \in I$, on a
    \begin{align*}
        f'_g(a) \leq f'_d(a)
    \end{align*}
\end{tcolorbox}

\noindent Pour $a \in I$, on note encore $g_a:I\backslash\{a\}\to \mathbb{R}; x\mapsto \frac{f(x) - f(a)}{x - a}$. \\
Comme $g$ est définie à gauche et à droite de $a$ ($I$ est ouvert) et que $g$ est croissante sur $I\backslash\{a\}$, d'après le TLM $g$ admet des limites finies à gauche et à droite de $a$ et : 
\begin{align*}
    \lim_{a^+} g &= f'_d(a) \geq f'_g(a) = \lim_{a^-} g \\
    \forall x \neq a, f(x) &= \frac{f(x) - f(a)}{x-a}(x-a) + f(a) \\
    &\underset{x \to a^+}{\longrightarrow} f(a) \\
    &\underset{x \to a^-}{\longrightarrow} f(a)
\end{align*}

\setsection{10}
\section{Caractérisation des fonctions convexes par les variations de la dérivée}
\begin{tcolorbox}[title=Théorème 19.11, title filled=false, colframe=orange, colback=orange!10!white]
    Soit $f:I\to \mathbb{R}$ une fonction dérivable sur $I$. Alors $f$ est convexe si et seulement si $f'$ est croissante. 
\end{tcolorbox}

$\boxed{\Rightarrow}$ \\
On suppose $f$ convexe. Soit $x < y$. Soit $a$ tel que $x < a < y$. \\
D'après l'inégalité des pentes ($f$ est convexe), on a : 
\begin{align*}
    \frac{f(a) - f(x)}{a-x} \leq \frac{f(y) - f(x)}{y-x} \leq \frac{f(y) - f(a)}{y-a}
\end{align*}
En considérant les limiets $a\to x^+$ et $a\to y^-$ et par TCILPPL : 
\begin{align*}
    f'(x) \leq \frac{f(y) - f(x)}{y-x} \leq f'(y)
\end{align*}
Donc $f'$ est croissante. \\

$\boxed{\Leftarrow}$ \\
On suppose $f'$ croissante sur $I$. Soit $x < y$. Soit $a\in ]x, y[$. \\
On applique deux fois le TAF : on choisit $\alpha \in ]x, a[ \text{ et } \beta \in ]a, y[$ tels que :
\begin{align*}
    \frac{f(a) - f(x)}{-x+a} &= f'(\alpha) \text{ et } \frac{f(y) - f(a)}{y-a} = f'(\beta) \\
\end{align*}
Comme $f'$ est croissante, on a $f'(\alpha) \leq f'(\beta)$, soit :
\begin{align*}
    \frac{f(a) - f(x)}{a-x} &\leq \frac{f(y) - f(a)}{y-a} \\
    \text{donc } f(a) &\leq \frac{a-x}{y-x}f(y) + \frac{y-a}{y-x}f(x) \\
\end{align*}
Comme $a \in ]x, y[$, $a = \lambda y + (1-\lambda)x$ et aussi : 
\begin{align*}
    f(a) = f(\lambda y + (1-\lambda)x) \leq \lambda f(y) + (1-\lambda)f(x)
\end{align*}
Donc $f$ est convexe (sur $I$). 


\end{document}